/*! grapesjs-plugin-sproutvideo - 0.0.4 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],e):"object"==typeof exports?exports["grapesjs-plugin-sproutvideo"]=e(require("grapesjs")):t["grapesjs-plugin-sproutvideo"]=e(t.grapesjs)}("undefined"!=typeof self?self:this,function(t){return function(t){function e(o){if(r[o])return r[o].exports;var i=r[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},s=r(1),a=o(s),p=r(2),n=o(p),d=r(3),u=o(d);e.default=a.default.plugins.add("gjs-sproutvideo",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i({},e);(0,n.default)(t,r),(0,u.default)(t,r)})},function(e,r){e.exports=t},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],t.DomComponents),r=e.getType("video"),o=r.model,i=r.view,s=o.prototype.defaults;s.svUrl="//videos.sproutvideo.com/embed/",s.videoId2="";var a=o.extend({defaults:s,initialize:function(t,e){o.prototype.initialize.apply(this,[t,e]);var r=[];switch(this.get("provider")){case"sv":r=this.getSproutVideoTraits(),this.get("src")&&this.parseFromSrc(),this.set("traits",r)}},parseFromSrc:function(){o.prototype.parseFromSrc.apply(this);var t=this.get("provider"),e=this.parseUri(this.get("src")),r=e.query;switch(t){case"sv":var i=e.pathname.split("/").pop(),s=e.pathname.split("/").pop();this.set("videoId",s),this.set("videoId2",i);try{this.set("autoplay",!0===JSON.parse(r.autoplay))}catch(t){this.set("autoplay",!1)}try{this.set("loop",!0===JSON.parse(r.loop))}catch(t){this.set("loop",!1)}try{this.set("controls",!1===JSON.parse(r.bigPlayButton))}catch(t){this.set("controls",!0)}}},updateSrc:function(){switch(o.prototype.updateSrc.apply(this),this.get("provider")){case"sv":this.set("src",this.getSproutVideoSrc())}},getAttrToHTML:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=o.prototype.getAttrToHTML.apply(this,e);switch(this.get("provider")){case"sv":delete i.loop,delete i.autoplay,delete i.controls}return i},updateTraits:function(){var t=this.get("provider"),e=this.getSourceTraits();switch(t){case"yt":this.set("tagName","iframe"),e=this.getYoutubeTraits();break;case"vi":this.set("tagName","iframe"),e=this.getVimeoTraits();break;case"sv":this.set("tagName","iframe"),e=this.getSproutVideoTraits();break;default:this.set("tagName","video")}this.loadTraits(e),this.em.trigger("change:selectedComponent")},getProviderTrait:function(){var t=o.prototype.getProviderTrait.apply(this),e={value:"sv",name:"Sprout Video"};return t.options.push(e),t},getSproutVideoTraits:function(){return[this.getProviderTrait(),{label:"Video ID",name:"videoId",placeholder:"eg. 01234/56789",changeProp:1},this.getAutoplayTrait(),this.getLoopTrait(),this.getControlsTrait()]},getSproutVideoSrc:function(){var t=""+this.get("svUrl")+this.get("videoId")+"/"+this.get("videoId2")+"?";return t+=this.get("autoplay")?"autoPlay=true":"",t+=this.get("controls")?"&bigPlayButton=false":"",t+=this.get("loop")?"&loop=true":""}},{isComponent:function(t){var e="",r=/youtube\.com\/embed/.test(t.src),o=/player\.vimeo\.com\/video/.test(t.src),i=/videos\.sproutvideo\.com\/embed/.test(t.src),s=r||o||i;return("VIDEO"===t.tagName||"IFRAME"===t.tagName&&s)&&(e={type:"video"},t.src&&(e.src=t.src),s&&(r?e.provider="yt":o?e.provider="vi":i&&(e.provider="sv"))),e}}),p=i.extend({updateSrc:function(){i.prototype.updateSrc.apply(this);var t=this.model.get("provider"),e=this.model.get("src");switch(t){case"sv":e=this.model.getSproutVideoSrc()}this.videoEl.src=e},updateVideo:function(){i.prototype.updateVideo.apply(this);var t=this.model.get("provider");this.model;switch(t){case"sv":this.model.trigger("change:videoId")}},renderByProvider:function(t){var e=i.prototype.renderByProvider.apply(this,[t]);return"sv"===t&&(e=this.renderSproutVideo()),this.videoEl=e,e},renderSproutVideo:function(){var t=document.createElement("iframe");return t.src=this.model.getSproutVideoSrc(),t.frameBorder=0,t.setAttribute("allowfullscreen",!0),this.initVideoEl(t),t}});e.addType("video",{model:a,view:p})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1],t.BlockManager}}])});