/*! grapesjs-plugin-sproutvideo - 0.0.3 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],t):"object"==typeof exports?exports["grapesjs-plugin-sproutvideo"]=t(require("grapesjs")):e["grapesjs-plugin-sproutvideo"]=t(e.grapesjs)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(o){if(r[o])return r[o].exports;var i=r[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},s=r(1),a=o(s),n=r(2),p=o(n),d=r(3),u=o(d);t.default=a.default.plugins.add("gjs-sproutvideo",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i({},t);(0,p.default)(e,r),(0,u.default)(e,r)})},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.DomComponents),r=t.getType("video"),o=r.model,i=r.view,s=o.prototype.defaults;s.svUrl="//videos.sproutvideo.com/embed/",s.videoId2="";var a=o.extend({defaults:s,parseFromSrc:function(){o.prototype.parseFromSrc.apply(this);var e=this.get("provider"),t=this.parseUri(this.get("src")),r=t.query;switch(e){case"sv":var i=t.pathname.split("/").pop(),s=t.pathname.split("/").pop();this.set("videoId",s),this.set("videoId2",i);try{this.set("autoplay",!0===JSON.parse(r.autoplay))}catch(e){this.set("autoplay",!1)}try{this.set("loop",!0===JSON.parse(r.loop))}catch(e){this.set("loop",!1)}try{this.set("controls",!1===JSON.parse(r.bigPlayButton))}catch(e){this.set("controls",!0)}}},updateSrc:function(){switch(o.prototype.updateSrc.apply(this),this.get("provider")){case"sv":this.set("src",this.getSproutVideoSrc())}},getAttrToHTML:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=o.prototype.getAttrToHTML.apply(this,t);switch(this.get("provider")){case"sv":delete i.loop,delete i.autoplay,delete i.controls}return i},updateTraits:function(){var e=this.get("provider"),t=this.getSourceTraits();switch(e){case"yt":this.set("tagName","iframe"),t=this.getYoutubeTraits();break;case"vi":this.set("tagName","iframe"),t=this.getVimeoTraits();break;case"sv":this.set("tagName","iframe"),t=this.getSproutVideoTraits();break;default:this.set("tagName","video")}this.loadTraits(t),this.em.trigger("change:selectedComponent")},getProviderTrait:function(){var e=o.prototype.getProviderTrait.apply(this),t={value:"sv",name:"Sprout Video"};return e.options.push(t),e},getSproutVideoTraits:function(){return[this.getProviderTrait(),{label:"Video ID",name:"videoId",placeholder:"eg. 01234/56789",changeProp:1},this.getAutoplayTrait(),this.getLoopTrait(),this.getControlsTrait()]},getSproutVideoSrc:function(){var e=""+this.get("svUrl")+this.get("videoId")+"/"+this.get("videoId2")+"?";return e+=this.get("autoplay")?"autoPlay=true":"",e+=this.get("controls")?"&bigPlayButton=false":"",e+=this.get("loop")?"&loop=true":""}},{isComponent:function(e){var t="",r=/youtube\.com\/embed/.test(e.src),o=/player\.vimeo\.com\/video/.test(e.src),i=/videos\.sproutvideo\.com\/embed/.test(e.src),s=r||o||i;return("VIDEO"===e.tagName||"IFRAME"===e.tagName&&s)&&(t={type:"video"},e.src&&(t.src=e.src),s&&(r?t.provider="yt":o?t.provider="vi":i&&(t.provider="sv"))),t}}),n=i.extend({updateSrc:function(){i.prototype.updateSrc.apply(this);var e=this.model.get("provider"),t=this.model.get("src");switch(e){case"sv":t=this.model.getSproutVideoSrc()}this.videoEl.src=t},updateVideo:function(){i.prototype.updateVideo.apply(this);var e=this.model.get("provider");this.model;switch(e){case"sv":this.model.trigger("change:videoId")}},renderByProvider:function(e){var t=i.prototype.renderByProvider.apply(this,[e]);return"sv"===e&&(t=this.renderSproutVideo()),this.videoEl=t,t},renderSproutVideo:function(){var e=document.createElement("iframe");return e.src=this.model.getSproutVideoSrc(),e.frameBorder=0,e.setAttribute("allowfullscreen",!0),this.initVideoEl(e),e}});t.addType("video",{model:a,view:n})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.BlockManager}}])});